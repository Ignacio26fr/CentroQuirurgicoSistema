<div class="container">

    <h1>Formulario Quirúrgico</h1>
    <a href="/homeUsuario" class="btn btn-warning mb-3">Volver</a>
    <form action="/formulario/insertarDatos" method="post" enctype="multipart/form-data">
        {{#data}}
            <input type="hidden" name="paciente" value="{{paciente}}">
            <div class="form-group">
                <label for="fechaCirugia" style="background: yellow">Fecha de Cirugía:</label>
                <input type="date" class="form-control" id="fechaCirugia" name="fechaCirugia" required>
            </div>
            <div class="form-group">
                <label for="diagnostico" style="background: yellow">Diagnóstico Primario</label>
                <input type="text" id="filtroPrimario" class="form-control" placeholder="Escribe y te van apareciendo opciones" autocomplete="off" required>
                <div id="opcionesPrimario" class="opciones-primario">

                </div>
                <input type="hidden" id="primarioSeleccionado" name="primario">
            </div>

            <div class="form-group">
                <label for="diagnostico">Diagnóstico Secundario</label>
                <input type="text" id="filtroSecundario" class="form-control" placeholder="Escribe y te van apareciendo opciones" autocomplete="off">
                <div id="opcionesSecundario" class="opciones-secundario">

                </div>
                <input type="hidden" id="secundarioSeleccionado" name="secundario">
            </div>





            <div class="form-group">
                <label for="asa">Asa</label>
                <select class="form-control" id="asa" name="asa">
                    <option value="0">Seleccionar</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                </select>
            </div>

            <div class="form-group">
                <label for="espQuirurgica" style="background: yellow">Especialidad quirúrgica</label>
                <select class="form-control" id="espQuirurgica" name="espQuirurgica" required>
                    <option value="0">Seleccionar</option>
                    {{#espquirurgica}}
                        <option value="{{id}}">{{nombre}}</option>
                    {{/espquirurgica}}
                </select>
            </div>
            <div class="form-group">
                <label for="unidadFuncional" style="background: yellow">Unidad funcional</label>
                <select class="form-control" id="unidadFuncional" name="idUnidadFuncional" required>
                    <option value="0">Seleccionar</option>
                </select>
                <input type="hidden" id="idUnidadFuncionalSeleccionada" name="idUnidadFuncionalSeleccionada" >
            </div>

            <div class="mb-3">
                <label for="sitioAnatomico" style="background: yellow">Sitio Anatomico</label>
                <select class="form-control" id="sitioAnatomico" name="idSitioAnatomico" required>
                    <option value="0">Seleccionar</option>
                </select>
                    <input type="hidden" id="idSitioAnatomicoSeleccionada" name="idSitioAnatomicoSeleccionada" value="idSitioAnatomicoSeleccionada">

            </div>

            <div id="extra-fields-1" class="extra-fields" style="display:none;">
                <label for="espQuirurgica" >Especialidad quirúrgica 2 </label>
                <select class="form-control" id="espQuirurgica" name="espQuirurgica2" required>
                    <option value="0">Seleccionar</option>
                    {{#espquirurgica}}
                        <option value="{{id}}">{{nombre}}</option>
                    {{/espquirurgica}}
                </select>
            </div>
            <div id="extra-fields-2" class="extra-fields" style="display:none;">
                <label for="unidadFuncional" >Unidad funcional 2</label>
                <select class="form-control" id="unidadFuncional" name="idUnidadFuncional2" required>
                    <option value="0">Seleccionar</option>
                </select>
                <input type="hidden" id="idUnidadFuncionalSeleccionada2" name="idUnidadFuncionalSeleccionada2" >
            </div>
            <div id="extra-fields-3" class="extra-fields" style="display:none;">
                <label for="sitioAnatomico" >Sitio Anatomico 2</label>
                <select class="form-control" id="sitioAnatomico" name="idSitioAnatomico2" required>
                    <option value="0">Seleccionar</option>
                </select>
                <input type="hidden" id="idSitioAnatomicoSeleccionada" name="idSitioAnatomicoSeleccionada" value="idSitioAnatomicoSeleccionada">

            </div>

            <div class="mb-3">
                <label for="actoQuirurgicoPrincipal" style="background: yellow">Acto quirurgico principal</label>
                <select class="form-control" id="actoQuirurgicoPrincipal" name="actoQuirurgicoPrincipal" required>
                    <option value="0">Seleccionar</option>
                </select>
                <input type="hidden" id="idActoQuirurgicoPrincipalSeleccionado" name="idActoQuirurgicoPrincipalSeleccionado" >
            </div>


            <div class="form-group">
                <label for="detalleCirugia">Observación de la cirugia:</label>
                <textarea class="form-control" id="detalle" name="detalle" rows="4"></textarea>
            </div>



            <div class="form-group" >
                <label for="cirujano" style="background: yellow">Cirujano</label>
                <input type="text" id="filtroCirujano" class="form-control" placeholder="Escribe y te van apareciendo opciones" required autocomplete="off">
                <div id="opcionesCirujano" class="opcion-cirujano">

                </div>
                <input type="hidden" id="cirujanoSeleccionado" name="cirujanoSeleccionado">
            </div>


            <div class="form-group">
                <label for="ayudante1">Primer ayudante</label>
                <input type="text" id="filtroPrimer" class="form-control" placeholder="Escribe y te van apareciendo opciones" autocomplete="off">
                <div id="opcionesPrimer" class="opcion-primer"></div>
                <input type="hidden" id="primerSeleccionado" name="primerSeleccionado">
            </div>

            <div class="form-group">
                <label for="ayudante2">Segundo ayudante</label>
                <input type="text" id="filtroSegundo" class="form-control" placeholder="Escribe y te van apareciendo opciones" autocomplete="off">
                <div id="opcionesSegundo" class="opcion-segundo"></div>
                <input type="hidden" id="segundoSeleccionado" name="segundoSeleccionado">

                </select>
            </div>
            </article>
            <div class="form-group">
                <label for="anestesista" style="background: yellow">Anestesista</label>
                <input type="text" id="filtroAnestesista" class="form-control" placeholder="Escribe y te van apareciendo opciones" required autocomplete="off">
                <div id="opcionesAnestesista" class="opcion-anestesista" ></div>
                <input type="hidden" id="anestesistaSeleccionado" name="anestesistaSeleccionado" >
            </div>

            <div class="form-group">
            <label for="neonatologo">Neonatólogo</label>
            <input type="text" id="filtroNeo" class="form-control" placeholder="Escribe y te van apareciendo opciones" autocomplete="off">
            <div id="opcionesNeo" class="opcion-neo"></div>
            <input type="hidden" id="neoSeleccionado" name="neoSeleccionado" autocomplete="off">
        </div>

            <div class="form-group">
                <label for="instrumentador">Instrumentador Quirúrgico</label>
                <select class="form-control" name="instrumentador" id="instrumentador" autocomplete="off" >
                    <option value="">Seleccionar</option>

                </select>
            </div>

            <div class="form-group" >
                <label for="circulante" >Circulante</label>
                <select class="form-control" name="circulante" id="circulante" autocomplete="off">
                    <option value="">Seleccionar</option>

                </select>
            </div>

            <div class="form-group" >
                <label for="anestesiaTecnico" style="background: yellow">Técnico en Anestesia</label>
                <input type="text" id="filtroTecnico" class="form-control" placeholder="Escribe y te van apareciendo opciones" required autocomplete="off">
                <div id="opcionesTecnico" class="opcion-tecnico"></div>
                <input type="hidden" id="tecnicoSeleccionado" name="tecnicoSeleccionado"  >
            </div>

            <div class="form-group">
                <label for="anestesia" style="background: yellow" >Tipo de Anestesia</label>
                <select class="form-control" name="idTipoDeAnestesia" id="anestesia">
                    <option value="">Seleccionar</option>
                    {{#tipoAnestesia}}
                        <option value="{{id}}">{{nombre}}</option>
                    {{/tipoAnestesia}}
                </select>
            </div>
            <div class="form-group">
                <label for="horaIngresoQuirurgico" style="background: yellow">Hora de ingreso al centro quirurgico</label>
                <input type="time" class="form-control" name="horaIngresoAlCentroQuirurgico" id="horaIngresoAlCentroQuirurgico"
                       required>
            </div>
            <div class="form-group">
                <label for="horaInicioCirugia" style="background: yellow">Hora de inicio cirugia</label>
                <input type="time" class="form-control" name="horaInicio" id="horaInicioCirugia" required>
            </div>
            <div class="form-group">
                <label for="horaFinalizacion" style="background: yellow">Hora de finalizacion cirugia</label>
                <input type="time" class="form-control" name="horaFin" id="horaFinalizacionCirugia"
                       required>
            </div>
            <div class="form-group">
                <label for="horaEgreso" style="background: yellow">Hora de egreso del centro quirurgico</label>
                <input type="time" class="form-control" name="horaEgreso" id="horaEgreso" required>
            </div>
            <div class="form-group">
                <label for="horaNacimiento">Hora de nacimiento</label>
                <input type="time" class="form-control" name="horaNac" id="horaNacimiento">
            </div>
            <div class="form-group">
                <label for="proviene" style="background: yellow">Lugar de donde provino el paciente</label>
                <select class="form-control"  id="proviene" name="lugarProviene" required>
                    <option value="0"> Seleccionar</option>
                    {{#lugar}}
                        <option value="{{id}}">{{nombre}}</option>
                    {{/lugar}}
                </select>
            </div>
            <div class="form-group">
                <label for="egreso" style="background: yellow">Lugar a donde egreso el paciente</label>
                <select class="form-control" name="lugarEgreso" id="lugarEgreso" required>
                    <option value=""> Seleccionar</option>
                    {{#lugar}}
                        <option value="{{id}}">{{nombre}}</option>
                    {{/lugar}}
                </select>
            </div>
            <div class="form-group">
                <label for="caja" >Caja quirurgica usada</label>
                <input type="text" id="filtroCaja" class="form-control" placeholder="Escribe y te van apareciendo opciones" autocomplete="off">
                <div id="opcionesCaja" class="opcion-caja"></div>
                <input type="hidden" id="cajaSeleccionado" name="idCajaQuirurgica">
            </div>

            <div class="form-group">
                <label for="nQuirofano" style="background: yellow">N° quirofano usado</label>
                <select class="form-control" name="numeroQuirofano" id="numeroQuirofano" required>
                    <option value="">Seleccionar</option>
                    <option value="1"> 1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                </select>
            </div>
            <div class="form-group">
                <label for="conteo" style="background: yellow">Se realizo conteo?</label>
                <select class="form-control" name="conteo" id="conteo" required>
                    <option value="">Seleccionar</option>
                    <option value="1"> Si</option>
                    <option value="0">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="radio" style="background: yellow">Radiografia control?</label>
                <select class="form-control" name="radiograma" id="radio">
                    <option value="">Seleccionar</option>
                    <option value="1"> Si</option>
                    <option value="0">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="conteo" style="background: yellow">Hemoterapia?</label>
                <select class="form-control" name="hemoterapia" id="conteo">
                    <option value="">Seleccionar</option>
                    <option value="1"> Si</option>
                    <option value="0">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="cultivo" style="background: yellow">Cultivo?</label>
                <select class="form-control" name="cultivo" id="cultivo">
                    <option value="">Seleccionar</option>
                    <option value="1"> Si</option>
                    <option value="0">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="patagonico" style="background: yellow">Anatomia patoglogica?</label>
                <select class="form-control" name="anatomiaPatologica" id="patagonico">
                    <option value="">Seleccionar</option>
                    <option value="1"> Si</option>
                    <option value="0">No</option>
                </select>
            </div>
            <div class="form-group">
                <label for="codigo" style="background: yellow">Codigo de práctica anestésica segun AAARBA</label>
                <input type="text" id="filtroCodigo" class="form-control" placeholder="Escribe y te van apareciendo opciones" required autocomplete="off">
                <div id="opcionesCodigo" class="opciones-codigo"></div>
                <input type="hidden" id="codigosSeleccionado" name="codigosSeleccionado">
            </div>

            <div class="form-group">
                <label for="tipoCirugia" style="background: yellow">Tipo de cirugia</label>
                <select class="form-control" name="tipoCirugia" id="tipoCirugia"  required>
                    <option value="">Seleccionar</option>
                    {{#tipoCirugia}}
                        <option value="{{id}}">{{nombre}}</option>
                        {{/tipoCirugia}}

                </select>
            </div>
            <div class="form-group">
                <label for="tipoCirugia" style="background: yellow">Material protesico primario implantado usado</label>

                <input type="text" id="filtroMaterial" class="form-control" placeholder="Escribe y te van apareciendo opciones" required autocomplete="off">
                <div id="opcionesMaterial" class="opcion-material custom-select-option"></div>
                <input type="hidden" id="materialSeleccionado" name="materialProtesicoPrimario" >
            </div>

            <div class="form-group">
                <label for="cantidadMaterialPrimario">Cantidad de material protesico primario:</label>
                <input type="number" class="form-control" id="cantidadDeMaterialPrimario" name="cantidadDeMaterialPrimario" required>
            </div>

        <div id="tecnologiasCheckboxContainer" >
            <h5 style="background: yellow">Tecnologias usadas</h5>

                <div>
                    {{#tecnologiaUsada}}
                        <input type="checkbox" name="tecnologiasUsadas[]" class="tecnologiaUsada" value="{{id}}"> {{nombre}}

                    {{/tecnologiaUsada}}
                </div>
            </div>


        {{/data}}

        <button type="submit" class="btn btn-primary">Guardar</button>
    </form>
</div>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/public/js/funciones.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var today = new Date();
        var day = String(today.getDate()).padStart(2, '0');
        var month = String(today.getMonth() + 1).padStart(2, '0');
        var year = today.getFullYear();
        var todayDate = year + '-' + month + '-' + day;
        document.getElementById('fechaCirugia').value = todayDate;
    });
</script>

